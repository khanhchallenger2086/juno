!function(t){"use strict";spApi.systemRuleRecommendationFeed={serviceUrl:"https://recommendation.api.useinsider.com/",userBased:"{partnerId}/{language}/user/{userId}?details=true&size={size}&currency={currency}",similarViewed:'{partnerId}/{language}/similar/product/{itemId}?categoryList=["{categoryList}"]&details=true&size={size}&currency={currency}',similarBought:'{partnerId}/{language}/complementary/product/{itemId}?categoryList=["{categoryList}"]&details=true&size={size}&currency={currency}',mostViewedOfCat:'{partnerId}/{language}/most/viewed/product?categoryList=["{categoryList}"]&details=true&size={size}&currency={currency}',mostBoughtOfCat:'{partnerId}/{language}/most/purchased/product?categoryList=["{categoryList}"]&details=true&size={size}&currency={currency}',mostViewed:"{partnerId}/{language}/most/viewed/partner?details=true&size={size}&currency={currency}",mostPurchased:"{partnerId}/{language}/most/purchased/partner?details=true&size={size}&currency={currency}",mixedStrategy:'{partnerId}/{language}/mixed?strategy=[{mixedStrategies}]&userId={userId}&productId={itemId}&categoryList=["{categoryList}"]&details=true&size={size}&currency={currency}&productIds={productIds}',manualMerchandising:"{partnerId}/{language}/product/details/{productId}?details=true",highestDiscounted:'{partnerId}/{language}/highest/discounted/partner/?details=true&currency={currency}&categoryList=["{categoryList}"]&size={size}',trendingProducts:'{partnerId}/{language}/trending/products?details=true&categoryList=["{categoryList}"]&size={size}&currency={currency}',newArrivals:'{partnerId}/{language}/new-arrivals?details=true&categoryList=["{categoryList}"]&size={size}&currency={currency}',locationBased:"{partnerId}/{language}/most/purchased/product?details=true&size={size}&country={country}&city={city}&currency={currency}",checkoutRecommendation:'{partnerId}/{language}/complementary/product/{itemId}?categoryList=["{categoryList}"]&details=true&size={size}&currency={currency}',chef:"{partnerId}/{language}/chef?details=true&size={size}&userId={userId}&currency={currency}",mostValuableOfPartner:"{partnerId}/{language}/most/valuable/product?details=true&size={size}&currency={currency}",mostValuableOfCat:'{partnerId}/{language}/most/valuable/product?details=true&size={size}&currency={currency}&categoryList=["{categoryList}"]'};var e=function(e){this.campID=e,this.campCookieKey="sp-camp-"+this.campID,this.infoSettings=spApi.notifies[this.campID],this.mainSelector=t(".ins-preview-wrapper-"+this.campID),this.couponCodeStorageKey="sp-info-c-"+this.campID,this.assistantActive="2"===spApi.getCamp(this.campID).camp.noteType,this.elementSelectors={notificationContent:"ins-notification-content",elementLink:"ins-element-link",overlayContent:"#ins-frameless-overlay[data-camp-id="+this.campID+"]",minimizeButton:"div.ins-element-minimize-button:not(.ins-element-link)",closeButton:"ins-element-close-button",overlayCloseSelector:"#ins-frameless-overlay[data-camp-id="+this.campID+']:not([close-on-click="false"])',dataScrollAttribute:"data-scroll-element",formContainer:"ins-question-group-form",errorClass:"ins-validation-error",inputErrorText:"ins-input-error-text",addToCartButtonWrapper:".ins-add-to-cart-wrapper"};var i=function(t,e){var i="";return"id"===e?i="#":"class"===e&&(i="."),i+this.elementSelectors[t]}.bind(this);this.initialize=function(){this.setEvents()},this.setEvents=function(){t(document).on("getCoupon"+this.campID,function(t,e){n(e,this.campID)}.bind(this)),t(document).on("setCopyButton"+this.campID,d),t(document).on("closeCampaign"+this.campID,function(){p()}.bind(this)),this.mainSelector.on("click",i("elementLink","class"),function(e){var n=(t(this).parent().attr("id")||"").split("-")[0];t(this).closest(i("formContainer","id")).exists()&&"button"===n&&l()||a(e,this)}),this.mainSelector.on("click",i("minimizeButton"),function(){h()}),this.mainSelector.on("click",i("closeButton","class"),function(){p()}),t(document).on("click",i("overlayCloseSelector"),function(){p()}),t(document).on("loadFacebookSDK",this.loadFacebookSDK),t(document).on("recommendationViewEventCollection"+this.campID,function(t,e){v(e)})},this.loadFacebookSDK=function(t,e){var i,n,s,r,o;window.fbAsyncInit=function(){FB.init({appId:spApi.facebookMessenger.appId,xfbml:!0,version:spApi.facebookMessenger.apiVersion}),e()},i=document,n="script",s="facebook-jssdk",o=i.getElementsByTagName(n)[0],i.getElementById(s)||((r=i.createElement(n)).id=s,r.src="https://connect.facebook.net/"+spApi.getLang()+"/sdk.js",o.parentNode.insertBefore(r,o))},this.removeOverlay=function(){t(i("overlayContent")).remove()},this.removeCampaign=function(){this.mainSelector.remove(),this.removeOverlay()}.bind(this),this.closeWithEffect=function(){this.infoSettings.effectConfig&&this.infoSettings.effectConfig.close?(this.infoSettings.effectConfig.close.dialog.complete=this.removeCampaign,this.mainSelector.find(i("notificationContent","class")).effective(this.infoSettings.effectConfig.close)):this.removeCampaign()},this.makeMainSelectorInvisible=function(){this.mainSelector.css({display:"none",visibility:"hidden"})},this.sendDBLog=function(t,e){var i={type:t,campId:this.campID,referer:window.location.href,table:"campLogs"};e&&(i.otherProperties=e),spApi.worker.send("do-logging",i)},this.sendCloseLog=function(){spApi.updateCookie({key:this.campCookieKey,obj:{closed:!0},campId:this.campID,updateCookieType:"nolog"})},this.showAssistant=function(t){var e=n(void 0,this.campID);spApi.noteTimer({cId:this.campID,couponCode:e,redirectUrl:t}),this.closeWithEffect()};var a=function(e,n){var a,c=t(n),l="_blank"===c.attr("target"),d=t.trim(c.attr("href")),h=t(e.target).attr("href")||"",p=(c.parent().attr("id")||"").split("-")[0],f=c.hasClass("ins-close-on-click"),m=c.closest(".ins-element-content").attr("data-ga-join-text")||"",v=c.hasClass("ins-show-assistant"),g=c.hasClass("ins-element-copy-to-clipboard-button"),x=c.closest('div[id*="button"]'),y=r(x,this.elementSelectors.dataScrollAttribute),C=c.closest(i("formContainer","id")).exists(),S=r(c,"event-collection");a=!1,s(d)?a=!0:(y||C||S)&&(a=!0),(C&&l||g)&&(a=!1),a&&e.preventDefault();var b={id:c.attr("id"),text:"button"===p?t.trim(c.text()):""},w=JSON.parse(spApi.storageData(this.campCookieKey));w&&w.joined||(this.sendDBLog("camp-join",b),spApi.gaSend({campId:this.campID,type:"camp-join",extra:{joinText:m}}));var I={key:this.campCookieKey,obj:{joined:!0},campId:this.campID};if(spApi.updateCookie(I,"nolog"),this.assistantActive&&v)return this.showAssistant(d),!1;var D=t(t(x).attr(this.elementSelectors.dataScrollAttribute));return C||o(D),f&&!g&&(this.sendCloseLog(),spApi.gaSend({campId:this.campID,type:"closed"}),this.closeWithEffect()),s(h)&&s(d)||C||y?void 0:(u(d||h,S,c,l),!1)}.bind(this),c=function(t,e,i){if(!i)return!1;e?window.open(t,"_blank"):window.location.href=t},u=function(t,e,i,n){if(e)return m("click",i,t,n),!1;c(t,n,!1)},l=function(){return this.mainSelector.find(i("errorClass","class")).length>0||this.mainSelector.find(i("inputErrorText","class")).length>0}.bind(this),d=function(t,e){new InsClipboard(".ins-preview-wrapper-"+this.campID+" "+e).on("success",function(t){sQuery(t.trigger).hasClass("ins-close-on-click")&&p(),t.clearSelection()})}.bind(this),h=function(){var t={key:this.campCookieKey,obj:{triggerHide:"0"},campId:this.campID};spApi.updateCookie(t),this.makeMainSelectorInvisible(),spApi.showTrigger(this.campID,this.infoSettings.triggerSettings),this.removeOverlay()}.bind(this),p=function(){var e=JSON.parse(spApi.storageData(this.campCookieKey));e&&e.closed||this.sendDBLog("camp-step1-close"),this.sendCloseLog(),this.closeWithEffect(),t(document).trigger("framelessClose"+this.campID)}.bind(this),f=function(){var t=spApi.notifies[e].predictiveFeedSettings.feedSource;return{userBased:"ub",mostViewed:"mvop",mostPurchased:"mpop",similarViewed:"vtv",similarBought:"btb",mostViewedOfCat:"mvoc",mostBoughtOfCat:"mpoc",manualMerchandising:"pd",newArrivals:"naop",trendingProducts:"tpop",highestDiscounted:"hdop"}[t]||t},m=function(t,n,s,r){g({event:"recommendation_click",partner_name:partnerName,user_id:spApi.storageData("spUID"),session_id:spApi.getGAStyleSesId(),algorithm:f(),campaign_id:e,items:[n.closest("div").find(i("addToCartButtonWrapper")).attr("ins-product-id")]},function(){c(s,r,!0)})},v=function(t){g({event:"recommendation_view",partner_name:partnerName,user_id:spApi.storageData("spUID"),session_id:spApi.getGAStyleSesId(),algorithm:f(),campaign_id:e,items:t})},g=function(t,e){if(!spApi.sessionInit)return(e||function(){}).call(),!1;sQuery.ajax({type:"POST",url:"https://hit.api.useinsider.com/hit",data:t,dataType:"text",complete:function(){(e||function(){}).call()}})};return this.initialize(),this},i=function(e){this.campID=e;var i=spApi.notifies[this.campID];this.mainSelector=t(".ins-preview-wrapper-"+this.campID),this.formData=[],this.resizeEventSetted=!1,this.elementSelectors={errorClass:"ins-validation-error",closeButtonSelector:".ins-element-close-button",notificationContentSelector:".ins-notification-content",initializerSelector:".ins-slider:not(.ins-slider-initialized)",mainContainerSelector:"[data-main-selector=true]",activeSlideSelector:".ins-active-slide",pageSelector:".ins-slider-page",slidePagePrefix:"ins-qgf-slide-page",innerContainerSelector:".ins-slider-container",elementLink:"ins-element-link",dataScrollAttribute:"data-scroll-element",buttonSelector:'div[id*="button"]',formSelector:"#ins-question-group-form",isDisabledEmailCollectionClass:"ins-disable-collect-email",wheelContainer:"#ins-wheel-of-fortune-adaptive",webWheelContainer:"#ins-web-wheel-of-fortune-adaptive",insSliceContainer:".ins-slice-container",insSliceCountAttr:"data-wheel-slice",insWinnerSlice:".ins-wheel-winner-slice",insRelatedSlice:".ins-wheel-slice",insWheelWrapper:".insWheelWrapper",emailSelector:'input[type="email"]',answerContainer:".ins-survey-holder",questionWrapper:"[id*=ins-wrap-question]",textQuestionWrapper:"[id*=ins-wrap-question] [data-question-type=text]",textQuestionAnswers:"input[type=text], input[type=email], input[type=tel], [input[type=phone], [input[type=number]",checkboxQuestionWrapper:"[id*=ins-wrap-question] [data-question-type=checkboxes]",checkboxQuestionAnswers:"input[type=checkbox]",selectedRadio:"input[type=radio]:checked",selectedCheckbox:"input[type=checkbox]:checked",selectedDropdown:"select option:selected",emailInput:"input[type=email]",phoneInput:"input[type=tel]",dateInput:"input[type=date]",textInput:"input[type=text]",currentQuestion:".ins-element-question > [id*=ins-question]",questionTitle:".ins-question-title",questionOption:"input[id*=ins-option]",questionPrefix:"ins-question-",otherText:".ins-other-text",otherTextPrefix:"ins-other-text-",requiredTextPrefix:"ins-required-text-",optionPrefix:"ins-option-",couponCodeHolder:".ins-survey-coupon-code",countryPhoneCodeSelector:"ins-phone-country-code",buttonElement:"[id*=button].ins-element-link",dynamicInput:"ins-dynamic-input",inputErrorText:"ins-input-error-text",dynamicCountryCode:"ins-dynamic-country-code",phoneCountryContent:"ins-phone-country-code-content",progressBar:"ins-progress-bar"},this.initialize=function(){this.setEvents(),t(document).on("framelessCampaignShown"+this.campID,function(){this.initSlider(),this.fillCountryCode(),A()}.bind(this))};var a=function(t,e){var i="";return"id"===e?i="#":"class"===e&&(i="."),i+this.elementSelectors[t]}.bind(this);this.setEvents=function(){this.mainSelector.on("submit","form",function(t){return t.stopPropagation(),t.preventDefault(),!1}),this.mainSelector.on("click",a("buttonElement"),c(function(t){y(t)},1e3)),t(document).on("goToPage"+this.campID,function(t,e){this.goToPage(e)}.bind(this)),this.mainSelector.on("click",a("questionOption"),function(e){var i=f(m(t(e.target)));!0===i.other&&t(e.target).is(":checked")?this.showOtherTextArea(i):this.removeOtherTextArea()}.bind(this))},this.validateHelper=function(t,e,i){var n=!1,s=i?e.parent():e;return t?(e.removeClass(a("errorClass")),n=!0):(s.addClass(a("errorClass")),this.addValidationErrorText(e),n=!1),n},this.addValidationErrorText=function(e){if(this.isDynamicInput(e)){var i=t(e).attr("validation-error-color")||"#ff0000",n=t(e).attr("input-error-text")||"";if(t(e).removeClass(a("errorClass")),t(e).css("border-color",i),!this.isErrorAppended(e)){var s=t("<div />",{class:a("inputErrorText"),css:{color:i},html:n});t(e).after(s)}}},this.isErrorAppended=function(t){return t.parent().find(a("inputErrorText","class")).exists()},this.validateEmail=function(t,e){return this.validateHelper(spApi.validateEmail(t.val()),t,e)},this.validatePhoneNumber=function(t){return/^[0-9A-Z.]{6,15}$/.test(t)},this.validatePhone=function(t,e){return this.validateHelper(this.validatePhoneNumber(t.val()),t,e)},this.validateInteger=function(e){var i=Number(t(e).val());return"number"==typeof Number(i)},this.initSlider=function(){this.checkInitConditions()&&(this.setSliderConfigurations(),this.captureOrientationChanges(),this.setInitializeClass(),this.setProgressBarPosition(0))},this.setInitializeClass=function(){this.mainSelector.find(a("initializerSelector")).addClass("ins-slider-initialized")},this.captureOrientationChanges=function(){this.resizeEventSetted||(this.resizeEventSetted=!0,t(window).on("resize orientationchange",function(){var t=setTimeout(function(){setTimeout(function(){this.setSliderConfigurations(),this.adjustSliderSizeAccordingToActiveSlide()}.bind(this),250),clearTimeout(t)}.bind(this),250)}.bind(this)))},this.checkInitConditions=function(){var t=!0;return(this.mainSelector.find(a("pageSelector")).length<2||0===this.mainSelector.find(a("initializerSelector")).length)&&(t=!1),t},this.setWidthOfElement=function(t,e){this.mainSelector.find(t).css({width:e})},this.setSliderConfigurations=function(){this.setWidthOfElement(a("innerContainerSelector"),this.mainSelector.find(a("pageSelector")).length*this.mainSelector.find(a("mainContainerSelector")).width()),this.setWidthOfElement(a("pageSelector"),this.mainSelector.find(a("innerContainerSelector")).width()/this.mainSelector.find(a("pageSelector")).length),this.setPageIndexes()},this.getContainerMatrixList=function(){return{x:Number(this.mainSelector.find(a("innerContainerSelector")).css("transform").split(",")[4]),y:null,z:null}},this.moveSlideToSpecificLocation=function(t){this.mainSelector.find(a("innerContainerSelector")).css({transform:"translate3d(-"+t+"px, 0, 0)"})},this.adjustSliderSizeAccordingToActiveSlide=function(){var t=D().index(),e=this.getContainerMatrixList().x,i=this.mainSelector.find(a("pageSelector")).width();0!==Math.abs(e%i)&&this.moveSlideToSpecificLocation(t*i)},this.setPageIndexes=function(){this.mainSelector.find(a("pageSelector")).each(function(e){t(this).attr({id:a("slidePagePrefix")+"-"+e,"data-insider-slide":e,"data-insider-index":e})}.bind(this))},this.createNewQuestion=function(){return{type:null,id:null,text:null,options:[]}},this.checkQuestionIsRequired=function(t){var e=d();return t&&t.closest("[id^='ins-question']")&&(e=t.closest("[id^='ins-question']")),e.is(":visible")&&"true"===e.attr("data-required-question")},this.showErrorText=function(e){var i=h()[u()].id,n=p(i),s=t(a("requiredTextPrefix","id")+i),r=t(a("questionPrefix","id")+i);s.remove(),n.required&&r.find(a("answerContainer")).after(t("<div/>",{id:a("requiredTextPrefix")+i,text:e&&n.error_message?n.error_message_text:n.required_text}))},this.removeErrorText=function(){t(a("requiredTextPrefix","id")+h()[u()].id).remove()},this.showOtherTextArea=function(e){var i=e.id;t(a("otherTextPrefix","id")+i).exists()||t(a("optionPrefix","id")+i).parent().after(t("<input/>",{class:"ins-other-text",id:a("otherTextPrefix")+i,"data-relation":a("optionPrefix")+i,type:"text",placeholder:e.otherText}))},this.removeOtherTextArea=function(){t(a("otherText"),l()).remove()},this.setQuestionProperties=function(e,i,n){var s=x();e.id=e.questionId||m(s),e.type=e.type||s.attr("data-question-type"),e.text=t.trim(s.find('div[id="ins-question-text-'+e.id+'"], '+a("questionTitle")).text()),e.required_question=s.attr("data-required-question"),t.each(i,function(i,s){var r=t(s).attr("id"),o=t("[data-relation="+r+"]");e.options.push(t.extend({id:m(t(s)),text:o.exists()?o.val():t(s).val(),type:t(s).attr("data-answer-type")},n))})},this.saveTextQuestionResult=function(){D().find(a("textQuestionAnswers"),a("textQuestionWrapper")).each(function(e,i){var n=t(i),s="true"===n.attr("data-required-question");this.validationCheckOnAnswer(""!==n.val().trim()||!s,n)&&this.validateFormInput(this.getInputType(n),n.val(),s,n)&&(this.setAnswerData(n),this.removeErrorText())}.bind(this))}.bind(this),this.validateFormInput=function(t,e,i,n){var s=!1;if(""===e&&!i)return!0;switch(t){case"email":s=this.validateEmail(n);break;case"tel":s=this.validatePhone(n);break;case"number":s=this.validateInteger(n);break;case"text":s=!0}return s},this.saveTextAreaResult=function(){this.setTextAreaData()}.bind(this),this.saveCheckboxResult=function(){D().find(a("checkboxQuestionAnswers"),a("checkboxQuestionWrapper")).each(function(e,i){var n=t(i);this.validationCheckOnAnswer(n.is(":checked"),n)&&(this.setCheckboxData(),this.removeErrorText())}.bind(this))}.bind(this),this.saveSingleChoiceResult=function(){var e=this.assimilateAnswer(t(a("selectedRadio"),l()));this.validationCheckOnAnswer(e.exists()&&""!==e.val())?(this.setSingleChoiceData(),this.removeErrorText(),this.removeOtherTextArea()):this.showErrorText()},this.assimilateAnswer=function(e){return"true"===e.attr("data-other-option")&&(e=t(a("otherTextPrefix","id")+m(e))),e},this.saveMultipleChoiceResult=function(){var e=t(a("selectedCheckbox"),l());this.validationCheckOnAnswer(e.length>0)?(this.setMultipleChoiceData(),this.removeErrorText()):this.showErrorText()},this.saveDropdownResult=function(){var e=t(a("selectedDropdown"),l());this.validationCheckOnAnswer(e.length>0)?(this.setDropdownData(),this.removeErrorText()):this.showErrorText()},this.saveLinearResult=function(){var e=t(a("selectedRadio"),l());this.validationCheckOnAnswer(e.length>0)?(this.setLinearData(),this.removeErrorText()):this.showErrorText()},this.saveEmailResult=function(){var e=t(a("emailInput"),l());this.validationCheckOnAnswer(""!==e.val())?!this.validateEmail(e,!0)&&this.checkQuestionIsRequired(e)?this.showErrorText("validation"):(e.parent().removeClass(a("errorClass")),this.setEmailData(),this.removeErrorText()):this.showErrorText()},this.saveDateResult=function(){var e=t(a("dateInput"),l());this.validationCheckOnAnswer(""!==e.val())?(this.setDateData(),this.removeErrorText()):this.showErrorText()},this.saveYesNoResult=function(t){this.setYesNoData(t)},this.saveShortAnswerResult=function(){var e=t(a("textInput"),l());this.validationCheckOnAnswer(""!==e.val())?(e.parent().removeClass(a("errorClass")),this.setShortAnswerData(),this.removeErrorText()):this.showErrorText("required")},this.validationCheckOnAnswer=function(t,e){e=e||l();var i=this.checkQuestionIsRequired(e);return!i||(i&&t?(this.removeValidationError(e),!0):(this.addValidationError(e),!1))},this.addValidationError=function(t){t.addClass(a("errorClass")),this.addValidationErrorText(t)},this.getInputType=function(e){return t(e).attr("type")},this.setQuestionOptionText=function(t){var e=t.val();if("tel"===this.getInputType(t)){var i=t.siblings(a("countryPhoneCodeSelector","class"));e=(i.length>0?i:t.parent().siblings(a("countryPhoneCodeSelector","class"))).find("i").text()+" "+e}return e},this.removeValidationError=function(e){t(e).css("border-color",""),t(e).parent().find(a("inputErrorText","class")).remove(),e.removeClass(a("errorClass"))},this.isDynamicInput=function(t){return t.hasClass(a("dynamicInput"))},this.setAnswerData=function(t){var e=t;this.saveAnswerData(this.setQuestionOptions(e,{type:"text",questionId:m(e.closest(a("currentQuestion"))),text:this.setQuestionOptionText(e),id:m(e,3),inputType:v(e)||v(e.parent())}))},this.setTextAreaData=function(){var e=D().find(t("textarea"));this.saveAnswerData(this.setQuestionOptions(e,{type:"textarea",questionId:m(e.closest(a("currentQuestion"))),text:this.setQuestionOptionText(e),id:m(e,3)}))},this.setCheckboxData=function(){var e=D().find(a("selectedCheckbox"));t.each(e,function(e,i){var n=t(i);this.saveAnswerData(this.setQuestionOptions(n,{type:"checkbox",inputType:v(n),questionId:m(n.closest(a("currentQuestion"))),text:n.data("option-text"),id:m(n,3)}))}.bind(this))},this.setSingleChoiceData=function(){var t=l().find(a("selectedRadio"));this.saveAnswerData(this.setQuestionOptions(t,{type:"radio"}))},this.setMultipleChoiceData=function(){var t=l().find(a("selectedCheckbox"));this.saveAnswerData(this.setQuestionOptions(t,{questionType:"checkboxes",type:"checkbox"}))},this.setDropdownData=function(){var t=l().find(a("selectedDropdown"));this.saveAnswerData(this.setQuestionOptions(t,{type:"select"}))},this.setLinearData=function(){var t=l().find(a("selectedRadio"));this.saveAnswerData(this.setQuestionOptions(t,{type:"radio"}))},this.setEmailData=function(){var t=l().find(a("emailInput"));this.saveAnswerData(this.setQuestionOptions(t,{questionType:"text",type:"text"}))},this.setDateData=function(){var e=l().find(a("dateInput"));this.saveAnswerData(this.setQuestionOptions(e.val().split("-").map(function(e,i){var n="select-year";return 1===i&&(n="select-month"),2===i&&(n="select-day"),t("<input/>",{id:"ins-date-"+m(t(a("dateInput"))),"data-answer-type":n,value:e})}),{}))},this.setYesNoData=function(e){this.saveAnswerData(this.setQuestionOptions(e,{questionType:"text",type:"text",text:t.trim(e.text())}))},this.setShortAnswerData=function(){var t=l().find(a("textInput"));this.saveAnswerData(this.setQuestionOptions(t,{questionType:"text",type:"text"}))},this.setQuestionOptions=function(t,e){var i=this.createNewQuestion();return(e.questionType||e.questionId)&&(i.type=e.questionType,i.questionId=e.questionId,delete e.questionType,delete e.questionId),this.setQuestionProperties(i,t,e),i},this.saveAnswerData=function(t){var e=!1;this.formData.length>0?(this.formData.forEach(function(i){i.id===t.id&&(e=!0,i.options=t.options)}),e||this.formData.push(t)):this.formData.push(t)},this.isDisabledEmailCollection=function(){return t(a("formSelector")).hasClass(a("isDisabledEmailCollectionClass"))},this.getCouponType=function(){var e=a("formSelector"),i=r(e,"data-coupon")&&"send-mail"===t(e).attr("data-coupon"),n=t(a("emailSelector")).exists();return i&&n?"send-mail":"none"},this.getCurrentCouponCode=function(){return"send-mail"===this.getCouponType()?spApi.storageData("sp-info-c-"+this.campID):""},this.getNextAndPreviousSlideIndex=function(){var t=Number(D().data("insider-slide")),e=this.mainSelector.find(a("pageSelector")).length;return{next:t+1>=e?t:t+1,previous:t-1<=0?0:t-1,totalSlideCount:e}},this.goToNextPage=function(){this.goToPage(this.getNextAndPreviousSlideIndex().next)},this.goToPreviousPage=function(){this.goToPage(this.getNextAndPreviousSlideIndex().previous)},this.rightToLeftLanguage=function(){return["ar_AE","ar_AR","ar_EG","ar_ME","ar_SA","fa_FA","ur_UR"].indexOf(spApi.getLang())<0?-1:1},this.goToPage=function(t){var e=this.mainSelector.find(a("pageSelector")).width(),i=this.rightToLeftLanguage()*e*t;this.mainSelector.find(a("innerContainerSelector")).css({transform:"translate3d("+i+"px, 0, 0)","-webkit-transform":"translate3d("+i+"px, 0, 0)","-moz-transform":"translate3d("+i+"px, 0, 0)","-ms-transform":"translate3d("+i+"px, 0, 0)","-o-transform":"translate3d("+i+"px, 0, 0)"}),this.setActiveClassTo(t),this.setProgressBarPosition(t)},this.setActiveClassTo=function(t){this.mainSelector.find(a("pageSelector")).removeClass("ins-active-slide").eq(t).addClass("ins-active-slide")},this.setProgressBarPosition=function(t){var e=this.getNextAndPreviousSlideIndex().totalSlideCount,i=((parseInt(t)+1)/e*100).toFixed();this.mainSelector.find(a("progressBar","class")).css("width",i+"%")},this.checkAutoCloseStatus=function(t){return void 0!==t?t:void 0!==D().data("auto-close")},this.getAutoCloseTimeout=function(t){return void 0!==t?Number(t):D().data("auto-close")},this.goToDirection=function(t){var e=t.closest(a("buttonSelector")),i=a("dataScrollAttribute"),n=r(t,"href")&&!s(t.attr("href"))&&!r(t,"target"),c=r(e,i);n?window.location.href=t.attr("href"):c&&o(e.attr(i))},this.saveFormData=function(e,i,n){if(0===this.formData.length)return!1;var s=window.location!==window.parent.location?document.referrer:document.location.href;return t.ajax({type:"POST",url:"//"+partnerName+".api.useinsider.com/ajax.php?t=saveFormResult&campType=frameless",data:{formData:this.formData,spUID:spApi.storageData("spUID"),campId:this.campID,source:s,couponAction:{type:this.getCouponType(),email:t(a("formSelector")).find(a("emailSelector")).val(),couponCode:this.getCurrentCouponCode()}}}).done(function(){e&&setTimeout(function(){this.mainSelector.find(a("closeButtonSelector")).click(),setTimeout(function(){this.goToDirection(n)}.bind(this),300)}.bind(this),1e3*i),this.resetFormData()}.bind(this)),this},this.resetFormData=function(){this.formData=[]};var c=function(t,e){var i;return function(){var n=arguments;if(!i)return t.apply(this,n),i=!0,setTimeout(function(){return i=!1},e)}},u=function(){return D().index()},l=function(){return d().find(a("answerContainer"))},d=function(){return D().find(a("currentQuestion")).eq(0)},h=function(){var t=JSON.parse(i.formConfig);return t instanceof Array?t:[]},p=function(t){return h().filter(function(e){return e.id===t})[0]||{}},f=function(t){return h()[u()].options.filter(function(e){return e.id===t})[0]||{}},m=function(t,e){return(t.attr("id")||"").split("-")[e||2]},v=function(t){return t.attr("input-type")||t.attr("data-input-type")||""},g=function(e){var i=void 0!==spApi.wheelOfFortuneConfig.tour?spApi.wheelOfFortuneConfig.tour:7,n=void 0!==spApi.wheelOfFortuneConfig.speed?spApi.wheelOfFortuneConfig.speed:3,s=360*i+360/t(a("insSliceContainer")).attr(a("insSliceCountAttr"))*t(a("insWinnerSlice")).closest(a("insRelatedSlice")).index()*-1;t(a("insWheelWrapper")).css({transform:"rotate("+s+"deg)","-webkit-transform":"rotate("+s+"deg)","-moz-transform":"rotate("+s+"deg)","-ms-transform":"rotate("+s+"deg)","-o-transform":"rotate("+s+"deg)","-webkit-transition":"all "+n+"s cubic-bezier(0, .99, .44, .99)","-moz-transition":"all "+n+"s cubic-bezier(0, .99, .44, .99)","-ms-transition":"all "+n+"s cubic-bezier(0, .99, .44, .99)","-o-transition":"all "+n+"s cubic-bezier(0, .99, .44, .99)",transition:"all "+n+"s cubic-bezier(0, .99, .44, .99)"}),setTimeout(function(){e()},1e3*(n+1))},x=function(){return D().find(a("currentQuestion"))},y=function(e){var i=t(e.currentTarget),n=(h()[u()]||{}).id,s=p(n).type,r=function(e,i){var n=t(),s=!1,r={actionType:"next",redirectionIndex:"next"},o=h()[u()];if("single"===e||"linear"===e?s=(n=x().find(a("selectedRadio"))).length>0:"dropdown"===e?s=(n=x().find(a("selectedDropdown"))).length>0:"yes-no"===e&&(s=!0),s){var c="next";if(!o.send_via_answer)return r;if("linear"!==e)if("yes-no"===e){var l=i.data("answer-type");l&&(c="positive"===l?o.positive_text_page:o.negative_text_page)}else c=f(m(n)).redirect_page_index;else{var d=m(n);d<=o.rating_less?c=o.rating_less_page:d>=o.rating_more&&(c=o.rating_more_page)}return{actionType:"next"!==c?"redirect":"next",redirectionIndex:"next"!==c?c:"next"}}return r}(s,i),o=i.attr("slide-type")||r.actionType;if("prev"===o)return I(o,i,r.redirectionIndex);switch(s){case"checkboxes":case"text":this.saveTextQuestionResult(),this.saveCheckboxResult();break;case"single":this.saveSingleChoiceResult();break;case"multiple":this.saveMultipleChoiceResult();break;case"dropdown":this.saveDropdownResult();break;case"linear":this.saveLinearResult();break;case"date":this.saveDateResult();break;case"email":this.saveEmailResult();break;case"yes-no":this.saveYesNoResult(i);break;case"feedback":this.saveLinearResult(),this.saveTextAreaResult();break;case"shortAnswer":this.saveShortAnswerResult()}this.hasErrors()?this.isDisabledEmailCollection()&&g(function(){I(o,i)}):(this.isDisabledEmailCollection()||t(a("wheelContainer")).exists()||t(a("webWheelContainer")).exists()?g(function(){I(o,i)}):I(o,i,r.redirectionIndex),t(document).trigger("insValidationSuccess"+this.campID))}.bind(this);this.hasErrors=function(){var t=a("activeSlideSelector");return this.mainSelector.find(t).find(a("errorClass","class")).length>0||this.mainSelector.find(t).find(a("inputErrorText","class")).length>0},this.fillCountryCode=function(){t(a("dynamicCountryCode","class")).length>0&&spApi.loadJsonFile("countryPhoneCodes.json",function(t){C(b(t))})};var C=function(e){t(a("countryPhoneCodeSelector","class")).each(function(i,n){var s=t(e).find("option").clone(),r=t(n).find("select"),o=t(n).siblings("input"),a="true"===t(n).siblings("input").attr("data-default-country"),c="";r.append(s),c=a?JSON.parse(spApi.storageData("userLocation")||"{}").country:o.attr("country-code");var u=t('option[data-country-name="'+c.toLowerCase()+'"]:first');w(u.attr("value"),u.attr("data-country-name").toUpperCase(),r)}),S()},S=function(){t(a("countryPhoneCodeSelector","class")).on("change",function(){var e=t(this).find("option:selected");w(e.attr("value"),e.attr("data-country-name").toUpperCase(),t(this).find("select"))})},b=function(e){var i="",n=t("<select></select>");return t.each(e,function(e,s){i=t("<option></option>",{text:e.toUpperCase()+" "+s,value:s,"data-country-name":e}),n.append(i)}),n},w=function(t,e,i){var n=i.siblings(a("phoneCountryContent","class"));n.find("i").text(t),n.find("span").text(e),i.val(t)},I=function(t,e,i){switch(t){case"none":return;case"next":this.goToNextPage();break;case"redirect":"next"===i?this.goToNextPage():this.goToPage(i);break;case"prev":this.goToPreviousPage();break;case"submit":var n=e.parent().data("submit-close-timeout")||0;return void this.saveFormData(this.checkAutoCloseStatus(!0),this.getAutoCloseTimeout(n),e)}A(),this.isDisabledEmailCollection()||this.saveFormData(this.checkAutoCloseStatus(),this.getAutoCloseTimeout(),e)}.bind(this),D=function(){var t=this.mainSelector.find(a("activeSlideSelector"));return t.exists()?t:this.mainSelector.find(a("pageSelector"))}.bind(this),A=function(){var e=h()[u()];e&&e.add_to_coupon&&n(function(e){t(a("couponCodeHolder")).text(e.value)},this.campID)}.bind(this);return this.initialize(),this},n=function(e,i){var n="sp-info-c-"+i,s="//"+partnerName+".api.useinsider.com/ajax.php?t=getInfoCoupon";return null===spApi.storageData(n)&&t.ajax({type:"POST",url:s,data:{campId:i},async:!1,dataType:"text",retries:3,tryCount:0,error:function(e){if(500===e.status&&(this.tryCount++,this.tryCount<=this.retries)){var i=this;setTimeout(function(){t.ajax(i)},1e3)}},success:function(t){var s=JSON.parse(t);spApi.storeLog("campLogs",{type:"notify-coupon",campId:i,referer:s.value}),spApi.storageData(n,s.value,{path:"/",expires:7,domain:"."+window.location.hostname.replace("www.","")}),"function"==typeof e&&e(s)}}),spApi.storageData(n)}.bind(this),s=function(t){return""===t||"#"===t||t.indexOf("javascript:void")>-1},r=function(e,i){var n=t(e).attr(i);return void 0!==n&&!1!==n},o=function(e){if(!t(e).exists())return!1;var i=t(e).offset().top;t("html, body").animate({scrollTop:i},"slow")};document.addEventListener("framelessReady",function(t){var n=t.detail.campID;new i(n),new e(n)},!1)}(sQuery);